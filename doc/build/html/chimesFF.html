

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The ChIMES Calculator &mdash; chimes_calculator 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The ChIMES Calculator Serial Interface" href="serial_interface.html" />
    <link rel="prev" title="ChIMES Calculator Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> chimes_calculator
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">The ChIMES Calculator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sections">Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sec-chimes-calc">The ChIMES Calculator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-c-api">The C API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-fortran-api">The Fortran API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-python-api">The Python API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation-examples">Implementation Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="serial_interface.html">The ChIMES Calculator Serial Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="etc.html">Support for Linking with External Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="force_fields.html">ChIMES Parameter Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing ChIMES</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Unitzles.</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">chimes_calculator</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>The ChIMES Calculator</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/chimesFF.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-chimes-calculator">
<h1>The ChIMES Calculator<a class="headerlink" href="#the-chimes-calculator" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>ChIMES is a reactive explicitly many-bodied machine learned interatomic potential (ML-IAP) for which interactions are
computed on the basis of atom clusters. For example, the total ChIMES energy is given as:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   E_{n_\mathrm{B}}
   = \sum_{i_1}        ^{n_a} {}^{1}\!E_{i_1}
   + \sum_{i_1&gt;i_2}    ^{n_a} {}^{2}\!E_{i_1i_2}
   + \sum_{i_1&gt;i_2&gt;i_3}^{n_a} {}^{3}\!E_{i_1i_2i_3}
   + \dots
   + \sum_{i_1&gt;i_2\dots &gt;i_{n\mathrm{B}-1}&gt;i_{n\mathrm{B}}}^{n_a} {}^{n}\!E_{i_1i_2\dots i_n}

\end{eqnarray}</div><p>where <span class="math notranslate nohighlight">\(E_{n_\mathrm{B}}\)</span> is the total ChIMES system energy, <span class="math notranslate nohighlight">\(n_{\mathrm{B}}\)</span> is the maximum bodiedness,
<span class="math notranslate nohighlight">\({}^{n}\!E_{i_1i_2\dots i_n}\)</span> is the <span class="math notranslate nohighlight">\(n\)</span>-body ChIMES energy for
a given set of <span class="math notranslate nohighlight">\(n\)</span> atoms with indices <span class="math notranslate nohighlight">\(i = {i_1, i_2, \dots , i_n}\)</span>, and <span class="math notranslate nohighlight">\(n_a\)</span> is the total number of atoms in the system. In the
ChIMES framework, single-body energies are constant values and <span class="math notranslate nohighlight">\(n\)</span>-body energies are constructed from the product of
polynomials of transformed atom pair distances. Thus, a 2-body interaction would involve a single pair, <span class="math notranslate nohighlight">\(ij\)</span>, while a
three-body interaction would involve three pairs, <span class="math notranslate nohighlight">\(ij, ik,\)</span> and <span class="math notranslate nohighlight">\(jk\)</span>, a 4-body interaction would involve <span class="math notranslate nohighlight">\(4\choose 2\)</span> pairs,
and so on. Currently, the ChIMES calculator supports up to 4-body interactions.</p>
<p>For further details of the ChIMES ML-IAP, the reader is referred to the following. For a complete set of ChIMES references, see <a class="reference internal" href="citing.html#page-citing"><span class="std std-ref">Citing ChIMES</span></a>.</p>
<ol class="arabic simple">
<li>R.K. Lindsey*, L.E. Fried, N. Goldman, S. Bastea, <cite>J. Chem. Phys.</cite>           <strong>153</strong> ??     (2020). (<a class="reference external" href="http://google.com">link</a>)</li>
<li>R.K. Lindsey*, N. Goldman, L.E. Fried, S. Bastea, <cite>J. Chem. Phys.</cite>           <strong>153</strong> 054103 (2020). (<a class="reference external" href="https://doi.org/10.1063/5.0012840">link</a>)</li>
<li>R.K. Lindsey*, L.E. Fried, N. Goldman,            <cite>J. Chem. Theory Comput.</cite>  <strong>15</strong>  436    (2019). (<a class="reference external" href="https://doi.org/10.1021/acs.jctc.8b00831">link</a>)</li>
<li>R.K. Lindsey*, L.E. Fried, N. Goldman,            <cite>J. Chem. Theory Comput.</cite>, <strong>13</strong>  6222   (2017). (<a class="reference external" href="https://doi.org/10.1021/acs.jctc.7b00867">link</a>)</li>
</ol>
</div>
<div class="section" id="sections">
<h2>Sections<a class="headerlink" href="#sections" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="#sec-chimes-calc"><span class="std std-ref">ChIMES Calculator</span></a></li>
<li><a class="reference internal" href="#sec-c-api"><span class="std std-ref">C API</span></a></li>
<li><a class="reference internal" href="#sec-fortran-api"><span class="std std-ref">Fortran API</span></a></li>
<li><a class="reference internal" href="#sec-python-api"><span class="std std-ref">Python API</span></a></li>
<li><a class="reference internal" href="#sec-use-examples-api"><span class="std std-ref">Implementation Examples</span></a></li>
</ul>
<hr class="docutils" />
</div>
<div class="section" id="sec-chimes-calc">
<span id="id4"></span><h2>The ChIMES Calculator<a class="headerlink" href="#sec-chimes-calc" title="Permalink to this headline">¶</a></h2>
<p>The ChIMES Calculator source files are located in chimesFF/src. To use in a C++ code, simply include <code class="docutils literal notranslate"><span class="pre">chimesFF.h</span></code> in the target
code and instantiate a <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> object. Any such code must at least include the following operations, in order:</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">my_rank</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">chimesFF</span> <span class="n">my_chimesFF_object</span><span class="p">;</span>      <span class="c1">// Instantiate</span>
<span class="n">my_chimesFF_object</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">my_rank</span><span class="p">);</span> <span class="c1">// Set MPI rank (replace with zero if used in serial code)</span>
<span class="n">my_chimesFF_object</span><span class="p">.</span><span class="n">read_parameters</span><span class="p">(</span><span class="s">&quot;my_parameter_file&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>Note that the ChIMES calculator <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> class provides users with the following functions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="12%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Return Type</th>
<th class="head">Name</th>
<th class="head">Arguments and Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>void</td>
<td>init</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>int</td>
<td>MPI rank</td>
</tr>
</tbody>
</table>
<p class="last">Set the MPI rank. With the exception of error messages,
the ChIMES calculator will only print output for rank 0.</p>
</td>
</tr>
<tr class="row-odd"><td>void</td>
<td>read_parameters</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>string</td>
<td>Parameter file</td>
</tr>
</tbody>
</table>
<p class="last">Read the chimes parameter file.</p>
</td>
</tr>
<tr class="row-odd"><td>void</td>
<td>set_atomtypes</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="18%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>vector&lt;string&gt;</td>
<td>List of atom types defined by parameter file (updated by function)</td>
</tr>
</tbody>
</table>
<p class="last">Update the input vector with atom types in the parameter file.</p>
</td>
</tr>
<tr class="row-odd"><td>double</td>
<td>max_cutoff_2B</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>bool</td>
<td>Flag: If true, prints largest 2-body cutoff</td>
</tr>
</tbody>
</table>
<p class="last">Returns the maximum 2-body outer cutoff distance.</p>
</td>
</tr>
<tr class="row-odd"><td>double</td>
<td>max_cutoff_3B</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>bool</td>
<td>Flag: If true, prints largest 3-body cutoff</td>
</tr>
</tbody>
</table>
<p class="last">Returns the maximum 3-body outer cutoff distance.</p>
</td>
</tr>
<tr class="row-odd"><td>double</td>
<td>max_cutoff_4B</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>bool</td>
<td>Flag: If true, prints largest 4-body cutoff</td>
</tr>
</tbody>
</table>
<p class="last">Returns the maximum 4-body outer cutoff distance.</p>
</td>
</tr>
<tr class="row-odd"><td>void</td>
<td>compute_1B</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="27%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>int</td>
<td>Atom type index</td>
</tr>
<tr class="row-odd"><td>double</td>
<td>Energy (updated)</td>
</tr>
</tbody>
</table>
<p class="last">Update energy with the single atom contribution.</p>
</td>
</tr>
<tr class="row-even"><td>void</td>
<td>compute_2B</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type     Description</th>
<th class="head">&#160;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>double</td>
<td>Distance between two atoms, i and j</td>
</tr>
<tr class="row-odd"><td>vector&lt;double&gt;</td>
<td>Distance vector components for each atom</td>
</tr>
<tr class="row-even"><td>vector&lt;int&gt;</td>
<td>Type indices for atoms i and j</td>
</tr>
<tr class="row-odd"><td>vector&lt;vector&lt;double* &gt; &gt;</td>
<td>Force pointer ([atom index (out of 2)][component index (i.e. fx=0, fy=1, fz=3)])</td>
</tr>
<tr class="row-even"><td>vector&lt;double*&gt;</td>
<td>Stress tensor pointer ([s_xx, s_xy, s_xz, s_yx, s_yy, s_yz, s_zx, s_zy, s_zz])</td>
</tr>
<tr class="row-odd"><td>double</td>
<td>Energy</td>
</tr>
</tbody>
</table>
<p class="last">Update the force pointer, stress tensor pointer, and energy with the two-atom contribution.</p>
</td>
</tr>
<tr class="row-even"><td>void</td>
<td>compute_3B</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type     Description</th>
<th class="head">&#160;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>vector&lt;double&gt;</td>
<td>Distance between three atoms, i, j, and k</td>
</tr>
<tr class="row-odd"><td>vector&lt;vector&lt;double&gt; &gt;</td>
<td>Distance vector components for each atom</td>
</tr>
<tr class="row-even"><td>vector&lt;int&gt;</td>
<td>Type indices for atoms i, j and k</td>
</tr>
<tr class="row-odd"><td>vector&lt;vector&lt;double* &gt; &gt;</td>
<td>Force pointer ([atom index (out of 3)][component index (i.e. fx=0, fy=1, fz=3)])</td>
</tr>
<tr class="row-even"><td>vector&lt;double*&gt;</td>
<td>Stress tensor pointer ([s_xx, s_xy, s_xz, s_yx, s_yy, s_yz, s_zx, s_zy, s_zz])</td>
</tr>
<tr class="row-odd"><td>double</td>
<td>Energy</td>
</tr>
</tbody>
</table>
<p class="last">Update the force pointer, stress tensor pointer, and energy with the three-atom contribution.</p>
</td>
</tr>
<tr class="row-even"><td>void</td>
<td>compute_4B</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type     Description</th>
<th class="head">&#160;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>vector&lt;double&gt;</td>
<td>Distance between four atoms, i, j, k and l</td>
</tr>
<tr class="row-odd"><td>vector&lt;vector&lt;double&gt; &gt;</td>
<td>Distance vector components for each atom</td>
</tr>
<tr class="row-even"><td>vector&lt;int&gt;</td>
<td>Type indices for atoms i, j, k  and l</td>
</tr>
<tr class="row-odd"><td>vector&lt;vector&lt;double* &gt; &gt;</td>
<td>Force pointer ([atom index (out of 4)][component index (i.e. fx=0, fy=1, fz=3)])</td>
</tr>
<tr class="row-even"><td>vector&lt;double*&gt;</td>
<td>Stress tensor pointer ([s_xx, s_xy, s_xz, s_yx, s_yy, s_yz, s_zx, s_zy, s_zz])</td>
</tr>
<tr class="row-odd"><td>double</td>
<td>Energy</td>
</tr>
</tbody>
</table>
<p class="last">Update the force pointer, stress tensor pointer, and energy with the four-atom contribution.</p>
</td>
</tr>
</tbody>
</table>
<hr class="docutils" />
<div class="section" id="the-c-api">
<span id="sec-c-api"></span><h3>The C API<a class="headerlink" href="#the-c-api" title="Permalink to this headline">¶</a></h3>
<p>The C API (<code class="docutils literal notranslate"><span class="pre">wrapper-C*</span></code>) is located in <code class="docutils literal notranslate"><span class="pre">chimesFF/api</span></code>. This wrapper provides C style name mangling and creates a
set of C-style wrapper functions. The latter are needed because <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> natively uses vectors, which are not
supported in most other languages.</p>
<hr class="docutils" />
</div>
<div class="section" id="the-fortran-api">
<span id="sec-fortran-api"></span><h3>The Fortran API<a class="headerlink" href="#the-fortran-api" title="Permalink to this headline">¶</a></h3>
<p>The Fortran API (<code class="docutils literal notranslate"><span class="pre">wrapper-F*</span></code>) is located in <code class="docutils literal notranslate"><span class="pre">chimesFF/api</span></code>. This wrapper enables access to <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> functions
through the C API and handles other details like differences in array storage order.</p>
<hr class="docutils" />
</div>
<div class="section" id="the-python-api">
<span id="sec-python-api"></span><h3>The Python API<a class="headerlink" href="#the-python-api" title="Permalink to this headline">¶</a></h3>
<p>The Python API (<code class="docutils literal notranslate"><span class="pre">wrapper_py*</span></code>) is located in <code class="docutils literal notranslate"><span class="pre">chimesFF/api</span></code>. Like the Fortran API, this wrapper enables access to
<code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> functions through the C API, via ctypes.</p>
<hr class="docutils" />
</div>
<div class="section" id="implementation-examples">
<span id="sec-use-examples-api"></span><h3>Implementation Examples<a class="headerlink" href="#implementation-examples" title="Permalink to this headline">¶</a></h3>
<p>The following codes demonstrates how <code class="docutils literal notranslate"><span class="pre">chimesFF{h,cpp}</span></code> can be used to obtain the
stress tensor, energy, and per-atom forces for a given system configuration using C, C++
Fortran, and python. See the <code class="docutils literal notranslate"><span class="pre">main.*</span></code> files in each corresponding subdirectory of <code class="docutils literal notranslate"><span class="pre">chimesFF/examples</span></code>
for further implementation details. Note that sample system configurations (i.e. <code class="docutils literal notranslate"><span class="pre">*xyz</span></code> files) and
parameter files can be found in <code class="docutils literal notranslate"><span class="pre">serial_interface/test/configurations</span></code> and <code class="docutils literal notranslate"><span class="pre">serial_interface/test/force_fields</span></code>, respectively. For user
generated tests, note that <code class="docutils literal notranslate"><span class="pre">*.xyz</span></code> files must be fore orthorhombic systems, with lattice vectors provided in the comment line,
e.g. lx 0.0 0.0 0.0 ly 0.0 0.0 0.0 lz.</p>
<p>Disclaimer: These codes are for demonstrative purposes only and come with no guarantees.</p>
<ul>
<li><p class="first"><strong>C Example:</strong> The <code class="docutils literal notranslate"><span class="pre">main</span></code> function of this example includes the C API, <code class="docutils literal notranslate"><span class="pre">wrapper-C.{h,cpp}</span></code>, which creates a global static pointer to a <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> object.
The <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> pointer object is set up, i.e. by <code class="docutils literal notranslate"><span class="pre">set_chimes()</span></code>, and used for access to <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> member functions, etc.</p>
<blockquote>
<div><ul>
<li><p class="first">Compile with: <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">all</span></code></p>
</li>
<li><p class="first">Test with: <code class="docutils literal notranslate"><span class="pre">./test_wrapper-C</span> <span class="pre">&lt;parameter</span> <span class="pre">file&gt;</span> <span class="pre">&lt;xyz</span> <span class="pre">file&gt;</span></code></p>
</li>
<li><p class="first">Additional notes:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">*.xyz</span></code> files must not contain any information beyond atom type and x-, y-, and z- coordinate on coordinate lines.</li>
<li>This implementation does NOT use ghost atoms/layering thus the input system MUST have box lengths greater than two times the largest outer cutoff, or results will not be correct.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>C++ Example:</strong> The <code class="docutils literal notranslate"><span class="pre">main</span></code> function of this example creates an instance of <code class="docutils literal notranslate"><span class="pre">serial_chimes_interface</span></code> (i.e. a class inheriting <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code>,
which computes energy, per-atom forces, and stress tensor for an overall system). For additional details, see [<strong>REFERENCE THE SERIAL CHIMES INTERFACE</strong>]</p>
<blockquote>
<div><ul>
<li><p class="first">Compile with: <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test-CPP</span></code></p>
</li>
<li><p class="first">Test with: <code class="docutils literal notranslate"><span class="pre">./test-CPP</span> <span class="pre">&lt;parameter</span> <span class="pre">file&gt;</span> <span class="pre">&lt;xyz</span> <span class="pre">file&gt;</span> <span class="pre">&lt;nlayers&gt;</span></code></p>
</li>
<li><p class="first">Additional notes:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">&lt;nlayers&gt;</span></code> is an integer definiting how many layers of ghost atoms should be used. Note that <code class="docutils literal notranslate"><span class="pre">&lt;nlayers&gt;</span></code> should be large enough to prevent self-interaction across the periodic boundary.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Fortran Example:</strong> Similar to the C example, this <code class="docutils literal notranslate"><span class="pre">main</span></code> function establishes a pointer to a <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> object via <code class="docutils literal notranslate"><span class="pre">f_set_chimes()</span></code>.
The <code class="docutils literal notranslate"><span class="pre">f_set_chimes()</span></code> function call is defined in <code class="docutils literal notranslate"><span class="pre">wrapper-F.F90,</span></code> a wrapper for the C API <code class="docutils literal notranslate"><span class="pre">wrapper-C.cpp</span></code> (i.e which facilitates C-style access to
<code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> member functions, etc). Actual linking is achieved at compilation. See the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> for details.</p>
<blockquote>
<div><ul>
<li><p class="first">Compile with: <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">all</span></code></p>
</li>
<li><p class="first">Test with: <code class="docutils literal notranslate"><span class="pre">./test_wrapper-F</span> <span class="pre">&lt;parameter</span> <span class="pre">file&gt;</span> <span class="pre">&lt;xyz</span> <span class="pre">file&gt;</span></code></p>
</li>
<li><p class="first">Additional notes:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">*.xyz</span></code> files must not contain any information beyond atom type and x-, y-, and z- coordinate on coordinate lines.</li>
<li>This implementation does NOT use ghost atoms/layering thus the input system MUST have box lengths greater than two times the largest outer cutoff, or results will not be correct.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Python Example:</strong> This example accesses <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> functions through <code class="docutils literal notranslate"><span class="pre">wrapper_py.py</span></code>, a ctypes-based python API for access to the C API functions
(i.e. through <code class="docutils literal notranslate"><span class="pre">wrapper-C.cpp</span></code>). Once <code class="docutils literal notranslate"><span class="pre">wrapper_py.py</span></code> is imported, it is associated with a compiled C API library file, i.e. <code class="docutils literal notranslate"><span class="pre">libwrapper-C.so</span></code> and
can be used to access <code class="docutils literal notranslate"><span class="pre">chimesFF</span></code> member functions.</p>
<blockquote>
<div><ul>
<li><p class="first">Compile libwrapper-C.so with: <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">all</span></code></p>
</li>
<li><p class="first">Test with: python3 main.py &lt;parameter file&gt; &lt;coordinate file&gt;</p>
</li>
<li><p class="first">Additional notes:</p>
<blockquote>
<div><ul class="simple">
<li>Requires <code class="docutils literal notranslate"><span class="pre">libwrapper-C.so</span></code> in the same directory, which is generated via <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">all</span></code></li>
<li>Expects to be run with Python version 3.X</li>
<li>This implementation does NOT use ghost atoms/layering thus the input system MUST have box lengths greater than two times the largest outer cutoff, or results will not be correct.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ul>
<hr class="docutils" />
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="serial_interface.html" class="btn btn-neutral float-right" title="The ChIMES Calculator Serial Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="ChIMES Calculator Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Rebecca K. Lindsey, Nir Goldman, &amp; Laurence E. Fried

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>